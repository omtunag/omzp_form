<script>
const endpoint = 'https://script.google.com/macros/s/AKfycbx8NJ0JHRjsHy_NTXo4vUEzEY7qecqElKg7yZ8I9SuPSb5tXaIcKmZqEZiz8VzsnyXE/exec';

document.getElementById('omzp-form').addEventListener('submit', async e=>{
  e.preventDefault();

  // フォーム値を application/x-www-form-urlencoded 形式へ
  const body = new URLSearchParams(new FormData(e.target)).toString();

  try{
    await fetch(endpoint, {
      method : 'POST',
      mode   : 'no-cors',                       // ← CORS チェックを無視して送信
      headers: { 'Content-Type':'application/x-www-form-urlencoded' },
      body
    });

    // レスポンスは読めないので “送れた前提” で完了メッセージ
    alert('送信完了しました！');
    e.target.reset();
  }catch(err){
    console.error(err);
    alert('通信に失敗しました。時間をおいて再試行してください。');
  }
});
</script>
