<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OMZP投稿フォーム</title>
  <style>
    body{font-family:sans-serif;margin:2rem;max-width:480px}
    label{display:block;margin-top:1rem}
    button{margin-top:1.5rem;padding:.5rem 1rem}
  </style>
</head>
<body>
  <h1>OMZP投稿フォーム</h1>

  <form id="omzp-form">
    <label>商品名：<br><input name="product" required></label>
    <label>コメント：<br><textarea name="comment" rows="4"></textarea></label>
    <label>緯度：<br><input name="lat"  type="number" step="any"></label>
    <label>経度：<br><input name="lng"  type="number" step="any"></label>
    <button type="submit">送信</button>
  </form>

  <script>
    // ===== 送信先（Apps Script）URL =====
    const endpoint = 'https://script.google.com/macros/s/AKfycbx8NJ0JHRjsHy_NTXo4vUEzEY7qecqElKg7yZ8I9SuPSb5tXaIcKmZqEZiz8VzsnyXE/exec';

    document.getElementById('omzp-form').addEventListener('submit', async evt => {
      evt.preventDefault();                     // ページ遷移させない
      const formData = new FormData(evt.target);// フォーム内容をまとめる

      try {
        const res  = await fetch(endpoint, { method: 'POST', body: formData });
        const json = await res.json();          // Apps Script からの JSON を読む

        if (json.result === 'ok') {
          alert('送信に成功しました！');
          evt.target.reset();                   // フォームを空にする
        } else {
          throw new Error('サーバーからエラー応答');
        }
      } catch(err) {
        console.error(err);
        alert('送信に失敗しました。時間をおいて再試行してください。');
      }
    });
  </script>
</body>
</html>
